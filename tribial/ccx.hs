{-# LANGUAGE LambdaCase, TypeApplications #-}
{-# OPTIONS -Wall -fno-warn-tabs #-}

import Control.Arrow
import Data.List
import Data.Word

digits :: String
digits = ['0' .. '9'] ++ ['a' .. 'z'] ++
	['ぁ' .. 'ん'] ++ "\12443" ++
	['ァ' .. 'ヶ'] ++ "・ー、。."

fromI :: Integer -> [Word8]
fromI = (reverse .) . unfoldr $ \case
	0 -> Nothing
	n -> Just . first fromInteger . (uncurry $ flip (,)) $ n `divMod` 210

toDigits :: [Word8] -> String
toDigits = map (digits `genericIndex`)

fromD :: RealFrac a => Word -> a -> [Word8]
fromD ln = uncurry (\n f -> n ++ [210] ++ f)
	. (fromI *** convFrac ln) . properFraction

convFrac :: RealFrac a => Word -> a -> [Word8]
convFrac _ 0 = []
convFrac 0 _ = []
convFrac ln x = uncurry (:) . (id *** convFrac (ln - 1)) . properFraction $ x * 210

showDigitsFrac :: RealFrac a => Word -> a -> String
showDigitsFrac ln = toDigits . fromD ln

putDigitsFrac :: RealFrac a => Word -> a -> IO ()
putDigitsFrac ln = putStrLn . toDigits . fromD ln

ex1, ex2, ex3 :: Rational
ex1 = 22 / 9
ex2 = 39 / 11
ex3 = 0

{-

 0  1  2  3  4  5  6  7  8  9
10 11 12 13 14 15 16 17 18 19
20 21 22 23 24 25 26 27 28 29
30 31 32 33 34 35 36 17 38 39
40 41 42 43 44 45 46 47 48 49
50 51 52 53 54 55 56 57 58 59
60 61 62 63 64 65 66 67 68 69
70 71 72 73 74 75 76 77 78 79
80 81 82 83 84 85 86 87 88 89
90 91 92 93 94 95 96 97 98 99

-}

sample :: IO ()
sample = putStr . unlines
	$ map (uncurry (\n x -> n ++ " " ++ x)
	. (show @Int . truncate &&& showDigitsFrac 10 . recip))
		[1 .. 99 :: Rational]

pir :: Rational
pir = 3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841

er :: Rational
er = 2.7182818284590452353602874713526624977572470936999595749669676277240766303535475945713821785251664274274663919320030599218174135966290435479003342952605956307381323286279434907632338298807531952510190115738341879307021540891499348841675092447614606680822648001684774118537423454424371075390777449920695517027618386062613313845830007520449338265602976067371132007093287091274437470472306969772093101416928368190255151086574637721112523897844250569536967707854499699679468644549059879316368892
