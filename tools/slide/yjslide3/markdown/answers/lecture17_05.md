演習17-5 (解答)
===============

問い
----

LoggerをMonadクラスのインスタンスにする。 
(>>=)を定義せよ。

コメント
--------

難しかったかもしれない。
順を追って見ていこう。

解説
----

### 左辺

引数のパターンマッチの部分を作る。

    (>>=) :: Logger a -> (a -> Logger b) -> Logger b

第1引数のLogger aについては中身のログと値が必要である。
第2引数は関数なので中身に対するパターンマッチはできない。

    Logger l x >>= f = ...

### 右辺

第1引数の「値」にfを適用した結果は必要となるので

    Logger l x >>= f = ... f x ...

f xの結果のログと値を別々に使うのでパターンマッチで分解する。

    Logger l x >>= f = let Logger l' x' = f x in ...

新しいログは古いログに追加し新しい値はそのまま結果の値とする。

解答
----

    Logger l x >>= f = let Logger l' x' = f x in Logger (l ++ l') x'
